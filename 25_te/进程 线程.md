
## P T
- ==进程==
    - >资源分配 基本单位
    - PCB data 程序
        - PCB
            - used by os to管理 并发执行'进程
            - 包括
                - process标志、控制、资源信息，<span style="color:lightgray">cpu现场</span>
        - process vs 程序 
            - 根本区别
                - 动，静
            - same程序 run on不同数据集
                - → **不同**进程
            - --
        - 实体与**c**语言
            - PCB ——process优先级
            - 正文段——全局赋值变量，常量值(19,"string"
                - processes不能utilize全局变量 exchange 数据(无联系
                    - eg.协作/合作process间
                        - samely，数据库也no
            - 堆..—— 未赋值'局部变量，function调用实参传递值
            - 栈..—— malloc()动态分配存储区
    
    - process最大数目 limited by
        - 内存size
        ---
    - features
        - 并发
            - 不可再现性
            - 相对v
                - 与__有关
                    - 调度策略
            - ++lose++程序++封闭性++
                - 封闭性：
                    - 结果only up to 进程itself
                        - ↑lose的reason
                            - ==资源==共享、might存在互斥
                            - thus，结果与 速度 有关
                        - <span style="color:lightgray">非并发' still have 封闭性</span>
     ---                      
     
    ---
    - 原语
        - >不可中断'指令序列
        - 进程控制
            - no 分配CPU
                - ↑系统调用realize
                - --
            - process创建原语
                - 
                - 过程：
                    - step：
                        - 申请PCB
                        - 分配资源
                            - no cpu←调度work
                        - PCB初始化&insert to就绪队列
                        - return p标志号
                    - 会导致create 新进程’operation
                        - user： login；open.abrowser程序
                        - os: react to用户请求；启动程序执行
                            - <span style="color:lightgray"> no设备分配</span>
                    - 高级调度
            - ..就绪
            - ..阻塞
            -  ..终止..
        - **communication**
            - 信箱
                - >间接
                - 发送原语
                - 接收..
            - 共享内存
                - fastest 通信way
                    - allow 多个进程 直接visit same物理内存        
            - 管道Pipe
                - 单向
                    - size:a page of内存
                    - r w操作
                        - 一次一个p
                        - 均might堵塞
                - need 拷贝 data of 内核&user space
            - 消息传递
                - need 拷贝..
                - 格式化&排队 message
                - --
            - socket
                - different机器间'process
                    - 经过 协议栈(传输层以下
                        - <span style="color:lightgray">might related to数据加密、压缩</span>
    -  have 独立地址space
        - 各自私有
            - thus进程间交换数据：
                - 共享file、存储区，消息传递
    - ==状态==
        - 创建
       
        - **就绪**
            - 申请**处理器**(CPU)不被satisfy← changed to..
                - <span style="color:lightgray">即调度</span>
            - can由2type态转入
                - 阻塞，运行
                    - 运行→就绪
                        - reason
                            - 时间片到 (wait for next片
                            - appear更高优先级process
                        - occur进程切换
                            - cpu调度different进程excecute
                                - (运行→就绪means 调度another p执行
            - p被唤醒
                - means 重新竞争cpu
                    - 就绪队列 
                        - 按FIFO等principle排序
                    - 优先级按fix算法计算
                        - 可能增大
                    - <span style="color:lightgray">this态can't 直接work</span>
        - --
        - **运行**
            - >有且仅1 process working
            - get处理器运行 through 
                - 调度
                    - 优先级
                        - 动态..
                            - according to情况，动态adjust
                        - 静..
            - equipment：
                -  单处理器
                    - process
                        - 10个process
                            - 最多9就绪，1运行
                        - might all process死锁，no进程in运行态 
                    - 与I/O设备并行
                - 打印机
                    - 独占operation
                - --
            - can由2type态转入
                - 阻塞，运行
        - --
      
        - **阻塞**
            - >certain事件/资源 不满足而 wait
                - usually
                    - IO操作
                        - eg.keyboard
                        - r data from 磁盘
                    - 互斥or同步 data
                        - eg.wait信号or 等待进入 互斥临界区代码段
                - 资源
                    - not include 
                        - CPU
            - process_i请求
                - 所请求操作(在当前work’p_other)完成后，该process_i：
                    - 阻塞→就绪
            - only__转换 由process自身决定
                - 运行→阻塞
                    - ↑ <span style="color:lightgray">自己会变阻塞</span> need →就绪
                    - 只会由 运行→阻塞
        - 终止
<br>
    ---

- **线程**
    - >for减少时空开销
        - improve程序 并发执行程度，<span style="color:lightgray">improve效率</span>
            - any进程'T 均可 并发excecute
                - (同一or不同
    - include CPU现场
        - (PC PSW 通用R ，stack指针
            - 无独立地址space，共享belonged进程'space
                - ++通信++也share此space
                    - no调用
        - CPU调度基本单位
            - can 独立excecute程序
    - 线程'切换
        - might引起进程切换
            - p_1中的T_1切换为p_2的T_2
                - same进程中的T切换，不会..
    - --
    - ULT KLT
        - ULT
            - 调度单位：P
                - 同一p中
                    - 含1 or 100 ult，时间same
                - 跨进程，才need内核
                    - others 全in用户态
            - created by
                - user程序 or数据库
                    - in 任意操作系统 can work
        - KLT
            - 调度单位：T
                - 进程A:1 klt；..B: 100..
                    - B进程时间is 100A
            - 执行：
                - 同一p中，线程切换，开销更大
                    -  need用户→内核 切换
                        - <span style="color:lightgray">program实体 can在内核态运行</span>

    ---
    - 多T model
        - eg.多个线程,其中一个阻塞
            - 多对一(多ult映射到1klt
                - 一个influence whole 
                    - 进程阻塞
            - 一..一
                - 一一映射，不影响other klt
                    - ..不..
        - 3type
            - 多v1
                - ult由进程管理
            - 并发性better：
                - 1v1 多v多 ← 充分utilize klt
        -  应用eg
            - ..
                - web sever响应http请求
            - no need
                -  v较慢
                    - eg.人键盘输入
    - --
    - 线程优缺点
        - good
            - 便于通信，save资源；improve并发
        - drawback
            - 不安全
                - might一个错 influence whole
---
---

## cpu调度
- concept
    - 三级调度
        - 高(作业
            - >创建→就绪态
        - 中(内存
            - >节省内存
        - 低(P
- 进程切换
- 调度算法
    - 考虑因素
        - 公平、互斥、周转t
            - ↑互斥性not, a 同步机制
    - type
        - 先
        - 短
        - 比
        - 片
            - >多用户
        - 优
        - 队
## 同步、互斥
- base
    - type
        - 同步
            - >for 完成a certain任务，established相互合作关系of多p
            - 4principle
                - 空闲让进
                    - --
                - 忙则等待
                - 让权..
                    - --
                - 有限..
            - 对并发p同步
                - reason
                    - 并发p **异步**
                        - ~: 
                            - 各自独立的、不可预知的速度向前推进)
                            - ↑∴ need  assure p'先后次序
                            - eg.p_r与p_w 对同一段缓冲区' r w
                                    - --
                                - discern：一段体现同步，一element体现互斥
                                    - through 共享缓冲区协作complete data处理
        - 互斥
- --
- 临界区互斥
    - base
        - **临界区**
            - >**代码** of visiting**临界资源** in 进程 <span style="color:lightgray">←多p together share 系统资源</span>
                - 临界资源：
                    - >互斥的 共享资源
                        - 该r is 可共享的
                            - 但 1次 only 1p use
                                    - --
                                - eg.
                                    - printer、 共享变量、共享缓冲区
                                        - ↑非共享数据 not
                                    - 公用queue
                                        - ↑可重入代码not ←1次可多p
                                            - link.共享程序段
                                                - ↑不允许修改'code
                                                    - 必use 可重入实现
            - 进入
                - 必互斥
                    - can存在：p未出区，便阻塞
                        - ↑other抢占处理器，but 不进入 该p的临界区
                            - --
                        - eg.p被中断 by申请等待I/O操作
- **互斥锁**
    - >二进制S, only 打开、关闭 
    - used in
        - >多T、P
            - ↑but only 解锁 by对它加锁' T / P
    - might死锁：
        - 循
            - ↑2T 对 2different 互斥锁先后加锁，but顺序相反
                - 例：T1对A加锁，then 对B加锁；
                    - 同时，T2先对B加锁，then 对A加锁
                        - ↑2T both wait 对方release，can't推进

    - --
- ==信号量&PV操作==
    - base
        - 信号量
            - >semaphore
            -  used in
                - 互斥
                - 同步
                    - ↑=execute 前驱关系
                    - discern：
                        - 并发
                            - ↑no need 信号量
            - --
            - type
                - **互斥量**
                    - >usually S_init=1 ←临界区only 允许 1p入
                        - S=0
                            - 已有1p 进入 临界区
                            - 区外 无other p 等待
                        - ..＜0
                            - 区中已有1p
                                - |S| = p数 of 区外等待
                                    - - -
                                    - eg. S=3--PV操作→S=-1
                                        - p_wait=1
                    - --
                    - PV操作中的 S初值
                        - set by 用户自身
                            - expect初值 
                                - 未产生
                                    - 则0
                                - 已..
                                    - 则非0正整数
                - 资源量
                    - >
                        - S=任意整数
                        - ..＜0
                            - r已用完
                            - |S| = p_wait数
            - --
        - PV操作
            - >**原语**of低级p通信
                - 原语
                    - ↑不可再分 指令序列
                        - ↑also 不可中断
            - type
                - p
                    - might导致
                        - 当前 临界区'p 阻塞
                - v
                   
- --
- 经典同步
    - P-C
    - R-W
        - - -
    <a id="section1"></a>
    - philosopher
        - >死锁：循环等待
            - 预防：
                - 同时check2支筷子 whether可用
                    - ↑资源浪费；
                        - but释放后，其他可用，不会饥饿
                - 奇拿左再拿右；偶相反
---
## 死锁deadly embrace
- base
    <a id="section2"></a>
    - **资源分配图**
        - >有向图：show R与P的状态
        - element：
            - 申请边
                - 有向边 of p→资源
            - 分配..
                - ...of p←资源
        - --
        - 表示ways：
            - 矩形框
                - 资源
                    - - -
                    - 圆点：
                        - 资源数目；
                    - 圆圈节点
                        - p
        - --
        - judge：
            - 死锁充要：
                -  环路&每类R仅1
                    - ↑无环，必不
                - 
    - --
    - discern：
        -  饥饿
            - >满足别人，自己得不到满足
    - --
    - 由code judge
- - -
- 条件(4
    - **必要**..
        - 互
            - >资源is独占的
        - 请
            - **预防**：
                - 一次性/**静态分配**all资源
                    - ↑不会partly占有
                    - 分配：
                        - count：
                            - >不死锁
                            -  x个进程，y类资源，z资源总数
                                - 求z最少
                                    - 死锁发生时分配(x*(y-1))+1
                                        - eg.3进程4类
                                            - 3*3+1
                                        ---
                                    -  special：
                                        - 进程数>z资源总数
                                            - also不会死锁
                                    - 注意
                                        - 同类时，每个进程需要y个
                                            - ↑regard as y类
                                - --
  
                    - link：
                        - 不能预防，反而加重条件：
                            - pv操作
                            - 进程互斥地use共享资源(？如何理解
                        - 检测only发生后work，can't预防
        - 不
            - >R使用后，由p自己释放
        - --
        - **循**
            - 例：
                - [philosopher](#section1)
                - 高优先级still might循环等待
            - 预防：
                    - resource**有序分配**
- **预防**
    - >破坏4条件之一
    - >可确保不死锁
    - 互
        - ↑无法破坏
            - 独 can't turn to互
- --
- 避免(==银行家==算法)
    - >add算法限制，during资源动态分配
        - 防止enter **不安全状态**
            - ↑死锁一定 不安全
                - ![Screenshot_2025-10-12-15-14-04-636_cn](https://github.com/bluejedis/picx-images-hosting/raw/master/OS/Screenshot_2025-10-12-15-14-04-636_cn.wps.moffice_eng-edit.54y5cncdvz.webp)
                - ↑安全一定无死锁
    - 算法：
        - base
            - >至少1p get all资源←at any time
            - condition
                - p已占有的r + 申请的资源数this time ≤ 对r 的最大需求量
                - && 现存r can meet 尚需的**最大**资源量
                    - ↑discern：
                        - 预防
                            - limit r: 顺序分配
                                - ↑银行家no
                        - 检测
                            - 不care 分配
                            - detect到死锁 才conduct措施
            - element：
                - ==安全序列==
                    - >按序列allocate后，不死锁
                        - attention：
                            - meet一个后，后面2个及2个以上p不满足，neither 安全序列
                                - eg.同类r共4，p1 p2 p3 max需求4 3 1；
                                    - 已分2 1 0
                                    - ↑无安全序列
                                        - 分给p3，后面p3**执行完后释放**1个r p1 p2 still抢
                    -- 
                    -  求：
                        - skill：
                            - >大部分情况下
                            - 优先meet：max-已分 ←最小
                                - ↑选择题 不考虑释放过程
                            ---
                        -  多p，多个r 分配
                            - usually 竖向考虑
                                - 43横看？
            -  process：
                - 
        - count
            - sum of 最大需求量
                - >m个总数，n个进程
                - 最极端
                    - n-1申请1个
                    - 剩余1个 apply m
                    - ？↑和之前结论有区别和联系吗
                        - ↑之前是算min
            - --
            - 26？这么做的原理，33、34同理
                - ↑按之前的allocation结论也能做
- --
- **检测、消除**
    - 检测
        - >detect [资源分配图](#section2) / 资源matrix

        - 死锁**定理**
    - 解/消除
        - 夺资
        - 销p
---
- left
    - 23、24 code
    - banker分配框图题
        - 26+33、34 +~~41~~、43
---
看选项要看完整

---        
