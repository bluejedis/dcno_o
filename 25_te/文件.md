## 文件
- concept
    - unix
        - >树形目录
        - 特殊文件
            - ↑ all设备均
        - 索引结构in索引节点
    - 文件
        - 属性
            - stored in FCB的访问控制信息
            - ↑对file 访问' limit
                - 由 user权限 & file属性共同
        - 文件表项
            - [多p映射同一F](./内存管理.md#sectionlink)
    - 安全管理
        - 系统级
            - login&注册
    - 存储介质
        - >file组织形式 与 介质特性有关
        - 磁带
            - produce
                - 顺序file
        - 磁盘
            - >随机存取
            - 管理ways
                - 位图
                - 空闲盘块链表
            - 扇区
                - >分配以簇为单位
        - cd
            - >连续
    - 性能
        - 异步I/O对 I/O次数无影响
- - -
- **FCB**
    - >文件控制块
        - 即 文件**目录项**
            - 与 文件 一对一
                - include File 物理位置info
                    - 首+length
                - not include FCB 物理..

    - 集合
        - 目录文件
        - --
    - inode
        - >描述info 从FCB中分离
            - better for 查找
        - 内存..
            - compared to磁盘
            - 特有
                - 访问计数值
- 操作
    - base操作
        - open
            - >copy FCB to内存
            - open()
                - 调用的参数
                    - include 需要打开的文件' 文件名
        - close
            - >FCB to磁盘
        - read
            - 调用参数 
                - no文件名
                    - ↑先use open
- 文件保护
    - type
        - ACL
            - >r w x
        - 精简控制
                ->o g o
        - 口令
    - 二进制
        - >1个file：五种权限、4类用户 可能同时拥有
            - 考虑max = 4*5=20
        - --
    - 防file受损
        - 备份
            - discern：
                - 存取控制matrix
                    - ↑多用户 权限保护
- - -
-  structure
    - 逻辑..(1 2 3
        - >user组织数据' 结构形式
            - for 方便 用户
        - 无结构file(流式
        - 有..(记录式
            - type：
                - 长
                    - 定长
                    - 变长
                - 序
                    - 顺序文件
                    - 索引..
                        - 组成：
                            - 逻辑文件
                            - 索引表
                                - ↑存取 先查
                                - 索引项
                                    - include
                                        - length + 起始**位置**in 逻辑文件
                                        - eg. store 磁盘存放位置
                    - 索引顺序..
                        - 转换
                            - 顺序file→索引顺序file
                                - 查找次数
                                    - = 组间查找次数 + 组内查找次数
                                        - 分组
                                            -  $\sqrt {顺序查找记录}$  /2
                                        - 组内
                                            - ..
                                            - ↑记录：
                                                - 存取操作'基本单位
                                                    - length可不等
        - --
    - 物理..(3
        - >组织ways由os决定
        - 按分配ways
            - 连续(顺序)
                - >随机存取分配
                    - ↑可跳转读
                - >外部piece
                - 操作
                    - 文件增加1项
                        - 磁盘I/O次数最多
                            - ↑之后每一项都需后移
                    - 插入1项
                        - ..
                            - ↑之前...前移
                                - 至少 读k次 + 写k次 +1新写
            - 链接
                - >not支持..
                - type
                    - 隐式
                        - ↑default
                        - **成组分解**
                            - 1个逻辑记录 不能拆分到2盘块
                                - ↑ 盘块最多存放记录条数
                                    - ⌈盘块size/逻辑记录size⌉ 
                            - count：
                                - 启动磁盘次数
                                    - 修改次数+1写回
                                        - ↑修改次数
                                            - = ⌈记录条数/盘块条数⌉ 
                                - 插入记录needed读写次数
                                    - >隐式 顺序读
                                    - 2写
                                        - new记录 写入空闲
                                        - 上相邻记录 指向new记录
                    - 显式
                        - 文件分配表(FAT
                            - function：
                                - record
                                    - 块 先后link关系
                                    - 空闲磁盘块
                                        - ↑∴ also can 管理空闲磁盘块
                ---
            -  索引
                - >支持随机..
                    - also can变长
                        - discern：
                            - 内存分配、磁盘分配
                - 索引表
                    - 插入
                        - cost小
                        - ↑only change内存，无IO
                    - 索引块
                        - ↑ 一级间接指针can指向1个
                            - ？37题1024怎么来的(left
                                
                - type：
                    - 单级索引
                        - no need 磁盘I/O的情况
                            - 单级索引+last数据块 insert 文件头部
                            - ↑FCB、索引块 已驻留内存
                    - 两级..
                        - count：
                            - max length
                                - 每级索引项数^2*盘块size
                                    - ↑每级索引项数
                                        - = 盘块size/块号size
                                    - ↑合并后通式
                                        - (盘块size)^3/(块号size)^2
                            - add索引指针 
                                - 求max length
                                    - 42题类似，求单个文件最大长度(left
                                    - --
                                    - 单个文件长度
                                        - 影响因素
                                            - no
                                                - **索引node总数**
                                                    - =总文件数
                                                        - eg.4B store 索引节点号
                                                            - ↑占4B位
                                                                - total =$2^{32}$
                                    - --
                                - 磁盘块个数
                                    - ？48
            - 散列
---
索引
多级←结构怎样？
37 42 48(left
求解思路

文件管理侧重于磁盘？

---
## 目录
- 文件目录
    - >按名存取
---
- 结构
    - 平均查找长度
        - 总长/2
            - ↑ds中 (1+总长)/2
    - 检索
        - 顺序
            - 路径名
                - 一个分量未找到
                    - stop
        - hash
            - 开销大
                - have 冲突&溢出
        ---
    -  structure
        - 根目录
        - 当前..
            - ↑相对path
            - 加快文件检索
            - --
        - 多级..
            - 解决命名冲突
            - - -
        -  树形..
            - 文件描述符(索引号)
                - ↑file open后使用
- 操作
- 实现
    - 线性
    - hash
        
- --
- 文件共享
    - 硬链接
        - 引用计数值
            - 1个 建立记2？
                - 删除-1
                - 为什么07题 F1 F2分别记2？
    - 软..(符号
        - >快捷方式
            - 删除file时不会直接delete
        - 引用计数值 
            - 不受link文件影响
                - 1个 就记1
---
---
## 文件系统
- 文件系统
    - 引入目的：
        - 系统角度
            - 组织分配 存储空间
        - user..
            - 按名存取
                - ↑ 逻辑文件系统function
                    - 按名存取
                    - 文件目录组织管理
                        - 文件名 → 文件描述符或文件句柄
                    - 存储保护
                        - ↑discern：with内存保护
    - --
    - 数量受限于
        - FCB块数
    - - -
    - 文件存储空间管理
        - = 文件**空闲**空间管理
- base
    - structure
        - 从上到下
            - 
    - 布局
        - 2块
            - 引导块
                - >启动
                    - 主引导扇区：
                        - 分区表+引导program
            - 超级块
                - >核心
        - 3区
- --
- 外存 空闲空间管理
    - type
        - 对外存file区管理
            - goal
                - improve 空间利用率
        - --
        - 空闲块管理：
            - **位示图**
                - ↑磁盘空间管理
                - >离散or连续
                - count
                    - 求字/位号
                        - >即 行列号
                        - type:
                            - 行/列号 从1始
                                - row=(块号-1)DIV 字长+1
                                - col=..  MOD..
                            - ... 从0..
                                - ？14题 (left
                        - --
                    - 用1位 表示簇数/页框
                        - >总/分size 个数 即bit数
                            - bit数/2^3=存储空间size
                            - GB=2^30B
                        - 求簇数
                            - storage空间大小/簇size
                        - 求所占storage空间大小
        - 空闲盘块号栈：
            - **成组链接**法
                - >离散+连续
                - discern：
                    - 唯一 only离散分配
                        - ↑空闲链表
                    - only连续
                        - ↑空闲表
 
  
- --
- VFS
    - 对象类型
        - 超级块
        - 索引节点
        - 目录项、文件
            - ↑no数据
- FS挂载
- --
- ？位示图
