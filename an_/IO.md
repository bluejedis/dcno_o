<div style="float: left; width: 64%; padding: 1%;">
[TOC]
<br>
好的，各位同学，我们来到最后一章《I/O管理》。这一章的内容相对零散，很多知识点与《计算机组成原理》重合，可以看作是计组知识在操作系统层面的应用。本章在考研中的分值占比不高，题目通常不难，属于“性价比”很高的复习内容。我们用最直观的方式，把这些看似琐碎的知识点串起来。

---

### <span style="color: lightgray;">第5章 输入/输出（I/O）管理

本章的核心是解决CPU与各种快慢不一的I/O设备之间的通信和效率问题。我们将从设备本身、控制方式、软件层次和磁盘管理四个方面来掌握它。

---

#### <span style="color: lightgray;">概述

##### **设备**<span style="color: gray;">(2+3类,3口,3 <span style="color: LimeGreen;">R</span>

* **核心考点:**
    * 设备的分类方法。
    * I/O接口（设备控制器）的组成与功能。
* **形象记忆法:**
    * 设备**分类** (多维度看设备):
        * 按**信息单位:**
            * **块设备:** 一次传一大块数据，可寻址。像**货车**，整箱拉货。如：硬盘。
            * **字符..:** 一次传一个字符，不可寻址。像**快递员**，一件件送。如：键盘、打印机。
            ---
        * 按**共享属性:**
            * **独占设备:** 同一时间只能一个进程用。像**私家车**。如：打印机。
            * **共享..:** 可多个进程同时（宏观上）用。像**公交车**。如：硬盘。
            * **虚拟..:** 用SPOOLing技术把“私家车”伪装成“公交车”。
    * **I/O接口** (设备控制器):
        * **角色:** CPU的“**专属秘书**”。
        * **为什么需要:** CPU很忙，没空直接管理慢吞吞的打印机、键盘。它把命令（如“打印这个文件”）告诉“秘书”，“秘书”去负责和设备打交道。
        * **组成:**
            * **与CPU的接口:** 听懂CPU的命令。
            * **与设备..:** 能指挥具体设备干活。
            * **I/O逻辑:** 内部的“大脑”，负责解码CPU命令、控制设备。
        * 三大 <span style="color: LimeGreen;">R</span>:
            * **<span style="color: LightSkyBlue;">数据</span>..:** 临时存放数据的“中转托盘”。
            * **状态..:** 记录设备“忙/闲/完成/出错”等状态的“工作日志”。
            *  **<span style="color: Gold;">控制**..: 存放CPU<span style="border-bottom: 2px solid black;">命令</span>的“指令便签”。
---
#####  <span style="color: Gold;">控制</span>方式<span style="color: gray;">(4:轮断D道

* **核心考点:**
    * 四种I/O控制方式的演进过程、原理和优缺点（**选择题高频考点**）。
* 形象记忆法 (CPU解放史):
    * **场景:** 你（CPU）让一位员工（I/O设备）去完成一项任务。
    1.  程序**直接**控制 (**轮询**): 你站在员工旁边，**不停地问“干完了没？”**。
        * **特点:** CPU**完全被占用**，效率极低。
    2.  **中断**驱动方式: 你给员工布置完任务就回去干自己的活。员工干完后，**主动来敲门告诉你（中断）**。
        * **特点:** CPU被解放，可以并行工作。但每次数据传输一个字/字节，员工就要来敲一次门，**中断频繁**。
        ---
    3.  **DMA** (直接内存存取):你雇了一个**项目助理 (DMA控制器)**。你告诉助理：“把这份文件（内存数据）交给那位员工处理”。助理负责整个数据搬运过程，**任务全部完成后**才来敲门告诉你。
        * **特点:** CPU只在任务开始和结束时介入，以**数据块**为单位，大大减少了中断次数。数据传输**不经过CPU**。
        ---
    4.  **通道控制方式:** 你雇了一个**高级部门经理 (通道)**，他有自己的“任务清单”（通道程序）。你只需告诉他：“按清单执行任务”。他能**管理多个项目助理和员工**。
        * **特点:** “准CPU”，能执行自己的指令集，CPU的干预进一步减少，<span style="border-bottom: 2px solid black;">并行</span>能力**最强**。

---
##### 
##### 软件层次结构<span style="color: gray;">(4:用独 驱断

* **核心考点:**
    * I/O软件的四个层次及其功能。
* **形象记忆法 (公司指令下达流程):**
    * 用户层**I/O软件**(你): 发出高级指令，如C语言的`printf("Hello")`。
    * 设备**独立性<span style="border-bottom: 5px dotted lightgray;">软件</span>** (CEO办公室):
        * **作用:** 屏蔽设备差异，提供统一接口。
        * **工作:** 接收你的`printf`指令。它不关心你是要打印到惠普打印机还是爱普生打印机。它负责设备命名、权限检查、分配/回收设备、**缓冲管理**等通用事务。
    * 设备**驱动程序** (部门经理):
        * **作用:** 针对**具体设备**的“<span style="border-bottom: 2px solid black;">翻译</span>官”和“司机”。
        * **工作:** CEO办公室把指令转给“打印机部门经理”，他知道如何把通用指令翻译成惠普打印机能懂的具体控制信号，并“驾驶”打印机工作。
    * **中断**处理程序 (紧急事件处理小组):
        * **作用:** 处理来自硬件的底层中断信号。
        * **工作:** 当打印机“缺纸”或“打印完成”时，硬件发出中断信号，该小组立刻介入，保存当前现场，处理中断，然后恢复现场。
---
##### 应用程序**I/O接口**<span style="color: gray;">(阻&非阻

* **核心考点:**
    * 阻塞I/O 与 非..的区别
* **形象记忆法 (去餐厅吃饭):**
    * **阻塞I/O:** 点完餐后，就坐在座位上**一直等**，直到服务员把菜端上来才能干别的事。
      * 进程在等待I/O时被<span style="border-bottom: 3px dotted black;">挂起</span>。
    * **非阻塞I/O:** 点完餐后，拿个号就去逛街了，但**每隔几分钟就跑回来**问“我的菜好了没？”。
      * 进程在等待I/O时可以继续运行，但需要自己不断<span style="border-bottom: 2px solid black;">轮询</span>检查I/O是否完成。

---
---

#### **设备独立性软件**

##### <span style="color: gray;">设备独立性软件<span style="color: gray;">(LUT

* **核心考点:**
    * 设备独立性的含义与好处。
    * 逻辑设备名到物理设备名的映射。
* **形象记忆法:**
    * 设备独立性: “打印”命令的普适性
        * **含义:** 应用程序员编程时，只需要使用一个<span style="border: 1px solid black; padding: 5px; display: inline-block;">**逻辑**</span>设备名（如`LPT1`代表打印机），而无需关心实际连接的是惠普还是佳能打印机（**物理设备名**）。
        * **实现:** 
          * 操作系统内部维护一张**逻辑设备表 (LUT,Look-up Table)**，负责将`LPT1`映射到具体的物理设备。
        * **好处:** 应用程序不依赖于具体硬件，可移植性强；更换设备时只需修改LUT表，无需修改应用程序。
---
##### 🧮**高速缓存 缓冲区**<span style="color: gray;">(单双

* **核心考点:**
    * 引入缓冲区的目的。
    * 单缓冲 和 双缓冲模式下的处理**时间**计算（**计算题考点**）。
* **形象记忆法:**
    * **目的:** 缓解CPU与I/O设备的速度矛盾，就像在生产线和货车之间建一个“**仓库**”。
    * **单缓冲:** **一个仓库**。货车（I/O）卸货时，生产线（CPU）只能等着；生产线取货时，货车只能等着。
    * **双缓冲:** **两个仓库**。货车可以往仓库A卸货，同时生产线从仓库B取货，两者可以**并行**。
    ---
* **计算题模板 (缓冲处理时间):**
    * **设:**
        * `T`: I/O设备输入一个**数据块**到缓冲区的时间。
        * `M`: 将数据从 **缓冲**区移到**用户**区的时间。
        * `C`: CPU<span style="border-bottom: 2px solid black;">处理</span>一个数据块的时间。
    * **单缓冲处理一块数据耗时:** 
      * $Max(T, C) + M$
    * **双..:**
      *  $Max(T, C + M)$
    * **解题技巧:** 画出时间轴，清晰标出T, M, C的串行和并行关系
---
##### **设备分配与回收**<span style="color: gray;">(SDT -> DCT -- COCT --> CHCT

* **核心考点:**
    * 设备分配时使用的 数据结构（DCT, COCT, CHCT, SDT）。
    * 设备分配的安全性。
* **形象记忆法 (公司资产管理):**
    * **数据结构:**
        * `SDT`: 公司**总资产清单**。
        * `DCT`: 每台**设备**的“说明书和状态牌”（忙/闲）。
          * `COCT`: 每个**设备控制器**（秘书）的“工作手册”。
        * `CHCT`: 每个**通道**（部门经理）的“职责范围”。
    * **分配过程:** 进程申请设备时，系统按`SDT -> DCT -> COCT -> CHCT`的顺序检查，确保设备、控制器、通道一路都是空闲的，才分配成功。
---
##### 
##### **SPOOLing**技术 (假脱机..)<span style="color: gray;">(virtual

* **核心考点:**
    * 原理和作用
* **形象记忆法:**
    * **SPOOLing** = 打印店的**后台服务**
      * **问题:** 打印机是独占设备，速度很慢。如果一个进程在打印，其他想打印的进程只能干等着。
    * **原理:** 用户请求打印时，系统并**不直接把数据送给打印机**，而是先把要打印的内容高速地输出到 <span style="border-bottom: 2px solid black;">磁盘</span>上的一个“**打印队列**”中。
      * 然后一个独立的“打印**进程**”在后台慢慢地从队列中取出文件，送给打印机打印。
    * **作用:**
        * 缓和 CPU 与 慢速设备 的矛盾。
        * 实现了设备的**共享**，多个进程可以同时“打印”（actually是输出到磁盘）
        * 实现了**虚拟设备**功能，把 <u>一台</u> 物理打印机虚拟成了 <u>多台</u> 逻辑打印机。
    * 核心**思想**: 用空间（**磁盘**）换时间（**CPU**）
---
##### 设备驱动程序**接口**

* **核心考点:**
    * 设备驱动程序的功能。
* **形象记忆法:**
    * 驱动程序是**设备独立性<span style="border-bottom: 2px solid black;">软件</span>** 和 设备 <span style="border-bottom: 2px solid black;">**控制器**</span> 之间的桥梁。
      * 向上层提供统一的、抽象的**接口**（如`read`, `write`）
      * 向下将这些抽象请求<span style="border-bottom: 2px solid black;">翻译</span>成具体设备控制器能听懂的硬件指令。

---
---
#### <span style="color: lightgray;">磁盘 固态硬盘

##### **磁盘** <span style="color: gray;">(3+2: 片道区 头面

* **核心考点:**
    * 物理结构（磁道、扇区、柱面）。
* **形象记忆法 (留声机唱片集):**
    * **盘片 (Platter):** 一张张的黑胶唱片。
    * **磁道 (Track):** 唱片上的一圈圈的轨道。
    * **扇区 (Sector):** 每条轨道上分的小格，是读写的最小单位。
    * 
    * **磁头 (Head):** 唱针。
    * **柱面 (Cylinder):** 所有唱片上**相同半径的磁道**组成的 <u>虚拟</u>圆柱体。
      * 切换**同一柱面**的**不同磁头（盘面）**，速度**远快于**移动磁头臂（**寻道**）
    ---
##### **管理**<span style="color: gray;">(3: 格 分 格

* **核心考点:**
    * 磁盘<span style="border-bottom: 2px solid black;">初始化</span>（低级格式化/物理格式化）。
    * 磁盘分区 与 逻辑格式化
* **形象记忆法 (新硬盘的使用):**
    1.  **低级格式化:** 
        -  在空白的盘片上 画出**磁道**和**扇区**的格子，让硬盘控制器能找到位置。
    2.  **分区:** 
        -  把一个大硬盘**分成几个逻辑盘**（C盘, D盘...）。
    3.  **逻辑..:** 
        -  在某个分区上**建立文件系统**（如NTFS, FAT32），即创建“超级块”、“inode区”等管理结构，让操作系统能存取文件。
    ---
##### 🧮**调度算法**<span style="color: gray;">2count: 调度t, 寻道| 5算法:先短 扫循 look

* **核心考点:**
    * 一次磁盘 r/w 操作的 时间构成 
    * 各种磁盘调度算法的规则和计算总**寻道**距离（**大题核心**）。
    ---
* **template (磁盘访问t):**
    * **总t** = **寻道**t + 旋转**延迟**t + 传输t
        * **寻道时间 ($T_s$):** 
          * 移动磁头→目标磁道的时间（题目通常会给）。
        * **旋转延迟.. ($T_r$):** 
          * **等待**目标扇区转到磁头下方的时间。
            * 平均为转一圈时间的一半。
            * 若转速为 `R` (转/分钟)，则转一圈时间为 `60/R` 秒。平均延迟为 $(60/R) / 2$ 秒。
        * **传输.. ($T_t$):** 
          * 实际**r/w**数据的t
    ---
* **template (磁盘调度):**
    1.  **画数轴:** 
        -  在纸上画一条数轴，标出所有要访问的**磁道号**和当前**磁头位置**。
    2.  **模拟移动:** 
        - 根据算法规则，在数轴上画出磁头的移动轨迹。
    3.  **计算距离:** 
        -  将每一段移动的距离（**磁道号**之**差**的绝对值）相加，得到总寻道距离。
    ---
* **算法精讲 (电梯调度):**
    * **FCFS (先来先服务):** 按<span style="border-bottom: 2px solid black;">请求顺序</span>服务。**公平但低效**。
    * **SSTF (最短寻道时间优先):** 总是去 离当前位置**最近**的请求。**高效**但可能“**饿死**”远处请求。
    * 
    * **SCAN (扫描/电梯算法):** 电梯朝**一个方向**移动，服务所有同向请求，直到磁盘末端再**掉头**。
    * **C-SCAN (循环扫描):** 电梯只朝一个方向服务。到末端后，直接返回**起始端**，再开始同向服务。**更公平**。
    * 
    * **LOOK / C-LOOK:** SCAN/C-SCAN的优化，磁头只需移动到**最远的请求处**即可掉头/返回，无需到磁盘末端。
    ---
##### 
##### **固态硬盘 (SSD)**<span style="color: gray;">(2+1均衡

* **核心考点:**
    * SSD与HDD的核心区别。
    * 磨损均衡。
* **形象记忆法:**
    * **HDD**(硬盘驱动器) vs **SSD:**
        * **HDD:** 像**留声机**，有旋转的盘片和移动的磁头，是机械式的。

        * **SSD:** 像**内存条**，由闪存芯片组成，是电子式的，没有移动部件。
    * **SSD特性:**
        * **优点:** 读写速度**快**（尤其随机读），**无**寻道和旋转**延迟**，防震，低功耗。
        * 核心**缺点:** **w**操作**复杂**。不能直接覆盖写，必须**先擦除**整个块，再写入页。
    ---
    * **磨损均衡 (Wear Leveling):**
        * **问题:** 闪存的每个块都有擦写次数**寿命**。
        * **技术:** SSD控制器会像一个“聪明的仓库管理员”，**确保所有存储块被均匀使用**，避免某些块因为被频繁擦写而“英年早逝”，从而延长整个SSD的寿命。

---
第五章的知识点虽然多，但只要抓住**CPU与设备间的效率矛盾**这条主线，就能理解各种技术（中断、DMA、缓冲、SPOOLing）的由来。磁盘调度算法是本章唯一的计算大题，务必熟练掌握模板。祝大家复习顺利！




</div>
<div style="float: right; width: 26%; padding: 1%;">

</div>
<div style="clear: both;"></div>
